<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .form-control {
            display: inline-block;
            width: auto;
        }
        .custom-range {
            display: inline-block;
            width: auto;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    @foreach($students as $student)
    <div class="card card-secondary collapsed-card">
        <div class="card-header">
            <h3 class="card-title">{{ $rank++ . '. ' . $student->name }}</h3>
            <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <div class="card-body collapse">
            <div class="form-group">
                <label for="student">ນັກສຶກສາ</label>
                <div class="row">
                    <input type="hidden" name="student_id[]" value="{{ $student->id }}">
                    <div class="col-4">
                        <input type="text" name="student_code[]" class="form-control" placeholder="ລະຫັດນັກສຶກສາ" value="{{ $student->student_id }}" disabled>
                    </div>
                    <div class="col-5">
                        <input type="text" name="name[]" class="form-control" placeholder="ຊື່ ແລະ ນາມສະກຸນ" value="{{ $student->name }}" disabled>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="lesson4">ເນື້ອໃນບົດທີ່ 4</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range lesson-4-range lesson-4" min="0" max="100" value="0" name="lesson_4_score[]">
                    <input type="number" class="form-control col-2 lesson-4-score" max="100" value="0" name="lesson_4_score[]">
                    @error('lesson_4_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="lesson5">ເນື້ອໃນບົດທີ່ 5</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range lesson-5-range lesson-5" min="0" max="100" value="0" name="lesson_5_score[]">
                    <input type="number" class="form-control col-2 lesson-5-score" max="100" value="0" name="lesson_5_score[]">
                    @error('lesson_5_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="document">ຄວາມສົມບູນຂອງເອກະສານ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range document-range" min="0" max="100" value="0" name="thesis_score[]">
                    <input type="number" class="form-control col-2 document-score" max="100" value="0" name="thesis_score[]">
                    @error('thesis_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="poster">Poster</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range poster-range" min="0" max="100" value="0" name="poster_score[]">
                    <input type="number" class="form-control col-2 poster-score" max="100" value="0" name="poster_score[]">
                    @error('poster_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="project">ຄວາມສົມບູນຂອງຊີ້ນງານ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range project-range" min="0" max="100" value="0" name="project_score[]">
                    <input type="number" class="form-control col-2 project-score" max="100" value="0" name="project_score[]">
                    @error('project_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="presentation">ຄະແນນການນໍາສະເໜີ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range presentation-range" min="0" max="100" value="0" name="present_score[]">
                    <input type="number" class="form-control col-2 presentation-score" max="100" value="0" name="present_score[]">
                    @error('present_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="qa">ຄະແນນການຕອບຄໍາຖາມ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range qa-range" min="0" max="100" value="0" name="qascore[]">
                    <input type="number" class="form-control col-2 qa-score" max="100" value="0" name="qascore[]">
                    @error('qascore.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="d-flex align-items-center gap-2">
                <label for="qa">ຄະແນນລວມ</label>
                <input type="number" class="form-control col-2 total-score" max="100" value="0" disabled name="total[]">
            </div>
        </div>
    </div>
    <div class="card card-secondary collapsed-card">
        <div class="card-header">
            <h3 class="card-title">{{ $rank++ . '. ' . $student->name }}</h3>
            <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <div class="card-body collapse">
            <div class="form-group">
                <label for="student">ນັກສຶກສາ</label>
                <div class="row">
                    <input type="hidden" name="student_id[]" value="{{ $student->id }}">
                    <div class="col-4">
                        <input type="text" name="student_code[]" class="form-control" placeholder="ລະຫັດນັກສຶກສາ" value="{{ $student->student_id }}" disabled>
                    </div>
                    <div class="col-5">
                        <input type="text" name="name[]" class="form-control" placeholder="ຊື່ ແລະ ນາມສະກຸນ" value="{{ $student->name }}" disabled>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="lesson4">ເນື້ອໃນບົດທີ່ 4</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range lesson-4-range lesson-4" min="0" max="100" value="0" name="lesson_4_score[]">
                    <input type="number" class="form-control col-2 lesson-4-score" max="100" value="0" name="lesson_4_score[]">
                    @error('lesson_4_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="lesson5">ເນື້ອໃນບົດທີ່ 5</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range lesson-5-range lesson-5" min="0" max="100" value="0" name="lesson_5_score[]">
                    <input type="number" class="form-control col-2 lesson-5-score" max="100" value="0" name="lesson_5_score[]">
                    @error('lesson_5_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="document">ຄວາມສົມບູນຂອງເອກະສານ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range document-range" min="0" max="100" value="0" name="thesis_score[]">
                    <input type="number" class="form-control col-2 document-score" max="100" value="0" name="thesis_score[]">
                    @error('thesis_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="poster">Poster</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range poster-range" min="0" max="100" value="0" name="poster_score[]">
                    <input type="number" class="form-control col-2 poster-score" max="100" value="0" name="poster_score[]">
                    @error('poster_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="project">ຄວາມສົມບູນຂອງຊີ້ນງານ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range project-range" min="0" max="100" value="0" name="project_score[]">
                    <input type="number" class="form-control col-2 project-score" max="100" value="0" name="project_score[]">
                    @error('project_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="presentation">ຄະແນນການນໍາສະເໜີ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range presentation-range" min="0" max="100" value="0" name="present_score[]">
                    <input type="number" class="form-control col-2 presentation-score" max="100" value="0" name="present_score[]">
                    @error('present_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="qa">ຄະແນນການຕອບຄໍາຖາມ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range qa-range" min="0" max="100" value="0" name="qascore[]">
                    <input type="number" class="form-control col-2 qa-score" max="100" value="0" name="qascore[]">
                    @error('qascore.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="d-flex align-items-center gap-2">
                <label for="qa">ຄະແນນລວມ</label>
                <input type="number" class="form-control col-2 total-score" max="100" value="0" disabled name="total[]">
            </div>
        </div>
    </div>
    <div class="card card-secondary collapsed-card">
        <div class="card-header">
            <h3 class="card-title">{{ $rank++ . '. ' . $student->name }}</h3>
            <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <div class="card-body collapse">
            <div class="form-group">
                <label for="student">ນັກສຶກສາ</label>
                <div class="row">
                    <input type="hidden" name="student_id[]" value="{{ $student->id }}">
                    <div class="col-4">
                        <input type="text" name="student_code[]" class="form-control" placeholder="ລະຫັດນັກສຶກສາ" value="{{ $student->student_id }}" disabled>
                    </div>
                    <div class="col-5">
                        <input type="text" name="name[]" class="form-control" placeholder="ຊື່ ແລະ ນາມສະກຸນ" value="{{ $student->name }}" disabled>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="lesson4">ເນື້ອໃນບົດທີ່ 4</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range lesson-4-range lesson-4" min="0" max="100" value="0" name="lesson_4_score[]">
                    <input type="number" class="form-control col-2 lesson-4-score" max="100" value="0" name="lesson_4_score[]">
                    @error('lesson_4_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="lesson5">ເນື້ອໃນບົດທີ່ 5</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range lesson-5-range lesson-5" min="0" max="100" value="0" name="lesson_5_score[]">
                    <input type="number" class="form-control col-2 lesson-5-score" max="100" value="0" name="lesson_5_score[]">
                    @error('lesson_5_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="document">ຄວາມສົມບູນຂອງເອກະສານ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range document-range" min="0" max="100" value="0" name="thesis_score[]">
                    <input type="number" class="form-control col-2 document-score" max="100" value="0" name="thesis_score[]">
                    @error('thesis_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="poster">Poster</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range poster-range" min="0" max="100" value="0" name="poster_score[]">
                    <input type="number" class="form-control col-2 poster-score" max="100" value="0" name="poster_score[]">
                    @error('poster_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="project">ຄວາມສົມບູນຂອງຊີ້ນງານ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range project-range" min="0" max="100" value="0" name="project_score[]">
                    <input type="number" class="form-control col-2 project-score" max="100" value="0" name="project_score[]">
                    @error('project_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="presentation">ຄະແນນການນໍາສະເໜີ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range presentation-range" min="0" max="100" value="0" name="present_score[]">
                    <input type="number" class="form-control col-2 presentation-score" max="100" value="0" name="present_score[]">
                    @error('present_score.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="form-group">
                <label for="qa">ຄະແນນການຕອບຄໍາຖາມ</label>
                <div class="d-flex justify-content-between align-items-center gap-2">
                    <input type="range" class="custom-range qa-range" min="0" max="100" value="0" name="qascore[]">
                    <input type="number" class="form-control col-2 qa-score" max="100" value="0" name="qascore[]">
                    @error('qascore.*')
                        <span class="text-danger">{{ $message }}</span>
                    @enderror
                </div>
            </div>
            <div class="d-flex align-items-center gap-2">
                <label for="qa">ຄະແນນລວມ</label>
                <input type="number" class="form-control col-2 total-score" max="100" value="0" disabled name="total[]">
            </div>
        </div>
    </div>
    @endforeach

    <script>
        $(document).ready(function() {
            // Function to synchronize inputs across all cards
            function synchronizeInputs(source, targetRange, targetNumber) {
                $(targetRange).val($(source).val());
                $(targetNumber).val($(source).val());
            }

            // Synchronize range and number inputs across all cards
            function addSyncListeners(rangeClass, numberClass) {
                $(`.${rangeClass}`).on('input', function() {
                    const index = $(`.${rangeClass}`).index(this);
                    const value = $(this).val();
                    $(`.${numberClass}`).eq(index).val(value);

                    // Synchronize across all cards
                    $(`.${rangeClass}`).not(this).val(value);
                    $(`.${numberClass}`).not(this).val(value);
                });

                $(`.${numberClass}`).on('input', function() {
                    const index = $(`.${numberClass}`).index(this);
                    const value = $(this).val();
                    $(`.${rangeClass}`).eq(index).val(value);

                    // Synchronize across all cards
                    $(`.${rangeClass}`).not(this).val(value);
                    $(`.${numberClass}`).not(this).val(value);
                });
            }

            // Apply synchronization to each group across all cards
            addSyncListeners('lesson-4-range', 'lesson-4-score');
            addSyncListeners('lesson-5-range', 'lesson-5-score');
            addSyncListeners('document-range', 'document-score');
            addSyncListeners('poster-range', 'poster-score');
            addSyncListeners('project-range', 'project-score');
            addSyncListeners('presentation-range', 'presentation-score');
            addSyncListeners('qa-range', 'qa-score');
        });

    </script>
</body>
</html>



// $(document).ready(function() {
    //     function calculateTotalScore(card) {
    //         let totalScore = 0;
    //         $(card).find('.custom-range').each(function() {
    //             totalScore += parseInt($(this).val()) || 0;
    //         });
    //         $(card).find('.total-score').val(totalScore);
    //     }

    //     function syncRangeAndNumber(card) {
    //         $(card).find('.custom-range').on('input', function() {
    //             let value = $(this).val();
    //             $(this).closest('.d-flex').find('.form-control').val(value);
    //             calculateTotalScore(card);
    //         });

    //         $(card).find('.form-control').on('input', function() {
    //             let value = $(this).val();
    //             $(this).closest('.d-flex').find('.custom-range').val(value);
    //             calculateTotalScore(card);
    //         });
    //     }

    //     $('.card-body').each(function() {
    //         syncRangeAndNumber(this);
    //         calculateTotalScore(this);
    //     });
    // });

    // function enableTotalScore() {
    //     $('.total-score').prop('disabled', false);
    // }
